
source prepare_test_env.sh

HISTIGNORE=$HISTIGNORE:"prompt_command":"#*":"history*"
#set -o history

# Run test command in test path
cd $test_path
echo "test command"
prompt_command

# Put several dummy commands on top of history in different directory 
cd $test_root
echo "lalala" > /dev/null
prompt_command
echo "lalala" > /dev/null
prompt_command
echo "lalala" > /dev/null
prompt_command

# Recover history for the test directory
hm -d $test_path

# Check last command in the history
history -2
last_command=$(get_last_command)
if ! [ "$last_command" = "$test_command" ]; then echo "Error! $last_command != $test_command"; [ 1 -eq 0 ]; fi
